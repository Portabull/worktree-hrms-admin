<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/common-style.css">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <title>License Registration</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e2a38, #3e576d);
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            height: 100%;
            overflow-y: auto;
            padding: 20px;
        }

        h1 {
            font-size: 3rem;
            color: #fff;
            margin-bottom: 30px;
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.5);
            animation: fadeIn 1s ease-in-out;
            text-align: center;
        }

        .cards {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 40px;
            width: 100%;
            max-width: 1200px;
        }

        .card {
            background: linear-gradient(145deg, #2f4157, #223140);
            border-radius: 20px;
            box-shadow: 10px 10px 20px rgba(0, 0, 0, 0.7), -10px -10px 20px rgba(70, 100, 130, 0.2);
            text-align: center;
            padding: 30px;
            width: 100%;
            max-width: 350px;
            position: relative;
            transition: transform 0.5s ease, box-shadow 0.5s ease;
            overflow: hidden;
            cursor: pointer;
        }

        .card:hover {
            transform: translateY(-15px);
            box-shadow: 15px 15px 25px rgba(0, 0, 0, 0.8), -15px -15px 25px rgba(70, 100, 130, 0.3);
        }

        .card img {
            width: 70px;
            margin-bottom: 20px;
            filter: drop-shadow(0 5px 5px rgba(0, 0, 0, 0.3));
        }

        .card h2 {
            font-size: 1.8rem;
            color: #fff;
            margin-bottom: 15px;
            text-shadow: 1px 1px 5px rgba(0, 0, 0, 0.4);
        }

        .card p {
            font-size: 1rem;
            color: #c4d3df;
            margin-bottom: 30px;
        }

        .card button {
            background: linear-gradient(145deg, #4caf50, #357a38);
            color: #fff;
            border: none;
            border-radius: 10px;
            padding: 12px 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.3s ease, background 0.3s ease;
        }

        .card button:hover {
            transform: scale(1.1);
            background: #3e8e41;
        }

        footer {
            margin-top: 30px;
            font-size: 1rem;
            color: #c4d3df;
            text-shadow: 1px 1px 5px rgba(0, 0, 0, 0.4);
            text-align: center;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }

            .cards {
                flex-direction: column;
                align-items: center;
                gap: 30px;
            }

            .card {
                width: 90%;
            }

            .card p {
                font-size: 0.95rem;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 2rem;
            }

            .card h2 {
                font-size: 1.5rem;
            }

            .card p {
                font-size: 0.9rem;
            }

            .card button {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
        }





         /* loader css starts */


 /* Rotate animation for the loader */
    .loading {
      animation: rotate 1s linear infinite;
    }

    /* Keyframes for the rotating animation */
    @keyframes rotate {
      100% {
        transform: rotate(360deg);
      }
    }



.loader-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(255, 255, 255, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    visibility: hidden; /* Hide loader by default */
}

.loader {
    border: 8px solid #f3f3f3; /* Light gray */
    border-top: 8px solid #3498db; /* Blue */
    border-radius: 50%;
    width: 50px;
    height: 50px;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* loader css ends */








    /* Overlay for dimming background */
    .modal-overlay9801245 {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        z-index: 999;
        display: none;
        animation: fadeIn9801245 0.3s ease;
    }

    /* Modal box styling */
    .modal-box9801245 {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 90%;
        max-width: 400px;
        background: white;
        color: #333;
        border-radius: 10px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        padding: 20px;
        text-align: center;
        animation: slideIn9801245 0.3s ease;
        overflow: hidden; /* Hide overflowing content initially */
        max-height: 300px; /* Set initial height */
    }

    /* Expanded modal box for long text */
    .modal-box-expanded9801245 {
        max-height: 70vh; /* Allow scrolling when expanded */
        overflow-y: auto;
    }

    /* Header */
    #errorHeader9801245 {
        font-size: 1.5rem;
        margin-bottom: 10px;
        color: #ff4d4d; /* Red for emphasis */
        font-weight: bold;
    }

    /* Message */
    .modal-message9801245 {
        font-size: 1rem;
        margin-bottom: 20px;
        line-height: 1.5;
        color: #555;
        max-height: 150px; /* Limit height for long text */
        overflow: hidden; /* Hide overflow initially */
        text-overflow: ellipsis;
    }

    /* Buttons container */
    #readMore9801245 {
        font-size: 0.9rem;
        color: #007bff;
        text-decoration: none;
        cursor: pointer;
        transition: color 0.2s;
        display: block;
        margin-bottom: 10px;
    }

    #readMore9801245:hover {
        color: #0056b3;
    }

    /* Okay button */
    #okayBtn9801245 {
        background: #4caf50;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 10px 20px;
        font-size: 1rem;
        cursor: pointer;
        transition: background 0.3s ease;
    }

    #okayBtn9801245:hover {
        background: #45a049;
    }

    /* Animations */
    @keyframes fadeIn9801245 {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }

    @keyframes slideIn9801245 {
        from {
            transform: translate(-50%, -60%);
            opacity: 0;
        }
        to {
            transform: translate(-50%, -50%);
            opacity: 1;
        }
    }


    </style>
</head>
<body>


<!-- Error Popup Modal -->
<div id="uniqueErrorModal9875">
    <div class="unique-modal-content9875" id="modalContent9875">
        <h2 id="errorHeader9875">Error Occurred</h2>
        <p id="errorFooter9875" class="message-container9875">An unexpected error has occurred. Please try again later.</p>
        <span class="read-more9875" id="readMore9875">Read more</span>
        <button id="uniqueOkayBtn9875">Okay</button>
    </div>
</div>

<!-- Improved Error Popup Modal -->
<div id="errorModal9801245" style="display: none;">
    <div class="modal-overlay9801245" id="modalOverlay9801245"></div>
    <div class="modal-box9801245">
        <h2 id="errorHeader9801245">Error</h2>
        <p id="errorMessage9801245" class="modal-message9801245">
            Please enable location access in your browser by clicking the lock icon next to the URL, selecting 'Site settings,' and allowing location. If the issue persists, contact support for further assistance. This is an example of a long error message to test the "Read More" functionality.
        </p>
        <a href="#" id="readMore9801245" style="display: none;" onclick="expandErrorPopup9801245(event)">Read more</a>
        <button id="okayBtn9801245" onclick="closeErrorPopup9801245()">Okay</button>
    </div>
</div>




<div id="loader" class="loader-overlay">
    <div class="loader"></div>
</div>



<h1>License Registration</h1>
<div class="cards">
    <!-- Trial User Card -->
    <div class="card">
        <img src="https://img.icons8.com/ios-filled/70/ffffff/clock.png" alt="Trial User">
        <h2>Trial User</h2>
        <p>For Trial License, please contact <br><a href="mailto:contact@worktree.com" style="color: #4caf50; text-decoration: none;">contact@worktree.com</a></p>
    </div>

    <!-- Licensed User Card -->
    <div class="card" onclick="triggerFileUpload()">
        <img src="https://img.icons8.com/ios-filled/70/ffffff/key.png" alt="Licensed User">
        <h2>Licensed User</h2>
        <p>Already have a License Key? <br>Click below to activate it.</p>
        <button onclick="triggerFileUpload(event)">Activate License Key</button>
        <input type="file" id="fileInput" style="display: none;" accept=".txt" onchange="handleFileUpload(event)">
    </div>
</div>
<footer>
    Copyright © 2024 Worktree Inc. All rights reserved.
</footer>
<script src="js/security.js"></script>
<script src="js/worktree.js"></script>
<script>
        function triggerFileUpload(event) {
    if (event) {
        // Prevent triggering the card's onclick event
        event.stopPropagation();
    }
    const fileInput = document.getElementById("fileInput");
    fileInput.value = ""; // Reset the file input value before triggering
    fileInput.click();
}

function handleFileUpload(event) {
    const file = event.target.files[0];
    if (file) {


       const fileExtension = file.name.split('.').pop().toLowerCase();
        if (fileExtension !== 'txt') {
            stopLoader();
              showErrorPopup9801245("Invalid File Type","Please upload a .txt file only.", true);
            return;
        }

        // Check file size (less than 10MB)
        const maxFileSize = 10 * 1024 * 1024; // 10MB in bytes
        if (file.size > maxFileSize) {
            stopLoader();
             showErrorPopup9801245("File Too Large","The file size must be less than 10MB.", true);
            return;
        }


        const formData = new FormData();
        formData.append("file", file);

startLoader();
        // Call dynamicXhrApi to upload the file
        dynamicXhrApi(
            "POST", // HTTP method
            BASE_URL + "api/licence", // Replace with your upload endpoint
            { Authorization: getCurrentToken() }, // Headers, if needed
            formData, // FormData with the file
            function (response, decryptedResponseObj) {
                if (response.status >= 200 && response.status < 300) {
                       gotohome();
                } else {
                    stopLoader();
                   showErrorPopup9801245("Error Occurred", decryptedResponseObj.message, true);
                }
            },
            true // Indicate that this is a file upload
        );
    }
}



function startLoader() {
    document.getElementById('loader').style.visibility = 'visible';
    document.body.style.pointerEvents = 'none'; // Disable interaction with the screen
}

window.addEventListener('pageshow', function(event) {
        // Check if the page is loaded from the cache
        if (event.persisted) {
            stopLoader();
        }
    });

function stopLoader() {
    document.getElementById('loader').style.visibility = 'hidden';
    document.body.style.pointerEvents = 'auto'; // Re-enable interaction with the screen
}




function showErrorPopup9801245(headerText, messageText, showReadMore = false) {
    // Set header and message
    document.getElementById("errorHeader9801245").innerHTML = headerText;
    document.getElementById("errorMessage9801245").innerHTML = messageText;

    // Check if the message is long and toggle "Read More"
    const messageElement = document.getElementById("errorMessage9801245");
    if (messageElement.scrollHeight > messageElement.clientHeight) {
        document.getElementById("readMore9801245").style.display = "block";
    } else {
        document.getElementById("readMore9801245").style.display = "none";
    }

    // Show modal and overlay
    document.getElementById("modalOverlay9801245").style.display = "block";
    document.getElementById("errorModal9801245").style.display = "block";
}

function expandErrorPopup9801245(event) {
    event.preventDefault();
    const modalBox = document.querySelector(".modal-box9801245");
    modalBox.classList.add("modal-box-expanded9801245");
    document.getElementById("readMore9801245").style.display = "none"; // Hide "Read More"
}

function closeErrorPopup9801245() {
    // Hide modal and overlay
    document.getElementById("modalOverlay9801245").style.display = "none";
    document.getElementById("errorModal9801245").style.display = "none";

    // Reset modal size
    const modalBox = document.querySelector(".modal-box9801245");
    modalBox.classList.remove("modal-box-expanded9801245");
}




    </script>
</body>
</html>
